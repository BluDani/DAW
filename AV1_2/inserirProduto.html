
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adicionar Produto</title>

    <link rel="stylesheet" href="myStyle.css">

    <script>

        function inserirProduto(){

            let form = document.getElementById("formProduto");
            console.log("Form: " + form.innerHTML);

            let id = document.getElementById("id").value;
            let nome = document.getElementById("nome").value;
            let valor = document.getElementById("valor").value;
            console.log("id: " + id + " nome: " + nome + " valor: " + valor);

            let form2 = {"id": id,"nome":nome,"valor":valor};
            let objJson = JSON.stringify(form2);
            console.log("objForm2: " + form2);
            console.log("JSON: " + objJson);

            //codigo copiado
            let xmlhttp = new XMLHttpRequest();
            console.log("1");

            xmlhttp.onreadystatechange = function(){

                if(this.readyState == 4 && this.status == 200){

                    console.log("Chegou a resposta OK: " + this.responseText);
                    console.log("2");
                    document.getElementById("msg").innerHTML = this.responseText;
                }
                else if (this.readyState < 4){

                    console.log("3: " + this.readyState);
                } 
                else{

                    console.log("Requisicao falhou: " + this.status);
                }
                    
            }
            console.log("4");

            xmlhttp.open("POST", "http://localhost/DAW/AV1_2/adicionarProduto.php");
            xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            xmlhttp.send("id=" + id + "&nome=" + nome + "&valor=" + valor);

            console.log("enviei form");
            console.log("5");
        }
    </script>
</head>
<body>
    
<form action="" method="POST" id="formProduto">

    ID <input type="text" name="id" id="id">
    <br><br>

    Nome <input type="text" name="nome" id="nome">
    <br><br>

    Valor <input type="number" name="valor" id="valor">
    <br><br>

    <input type="submit" value="Incluir" onclick="inserirProduto();">
</form>

</body>
</html>